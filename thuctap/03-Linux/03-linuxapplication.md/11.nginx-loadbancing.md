# Tìm hiểu về Loadbalancing
## 1. Loadbalancing là gì?
- Load Balancing là một kỹ thuật phân phối lưu lượng truy cập mạng hoặc khối lượng công việc giữa nhiều máy chủ hoặc thiết bị khác nhau. Bằng cách này, các máy chủ có thể chia sẻ tải công việc và tránh quá tải, từ đó cải thiện hiệu suất và độ tin cậy của hệ thống.
- Load Balancing có rất nhiều thuật toán để sử dụng với các mục đích khác nhau tùy vào các yêu cầu khác nhau của các bài toán đặt ra . Nhưng mục đích chính của nó chính là tạo ra giải pháp cân băng tải 
## 2. Các thuật toán của Load Balancing
### 2.1 Round - Robin
- Theo thuật toán này thì các request sẽ được gửi đi theo một cách công bằng đến tất cả các máy chủ web , Sẽ không có máy chủ nào nhận được nhiều và máy chủ nào nhận được ít mà nhận bằng nhau hết
  ![Alt](/thuctap/anh/Screenshot_711.png)
- Nhìn vào hình ta thấy server 1 và 2 nhận được các request tuần tự server 1 nhận 1 cái rồi server 2 nhận 1 cái cứ như vậy tiếp tục quay vòng
### 2.2 Weighted Round Robin
- Đây là thuật toán nâng cấp của Round - Robin 
- Nó dựa vào trọng số `Weight` của mỗi server ,nếu server nào có trọng số mạnh thì sẽ thực hiện nhiều còn server nào có trọng số thấp sẽ thực hiện ít
  ![Alt](/thuctap/anh/Screenshot_712.png)
  - Như trên thì  server 1 có weight =1 và server 2 có weight =3 thì trung bình cứ 4 request thì server 2 xử lý 3 cái còn server 1 sử lý 1 cái
### 2.3 Least Connection
- Đây là thuật toán nâng cấp của round robin và weighted load balancing, thuật toán này sẽ giúp tối ưu hóa cân bằng tải cho hệ thống
- Đặc điểm của thuật toán này là sẽ chuyển request đến cho server đang xử lý it hơn làm việc, thích hợp đối với các hệ thống mà có các session duy trì trong thời gian dài, tránh được trường hợp các session duy trì quá lâu mà các request được chuyển luân phiên theo quy tắc định sẵn , dễ bị down 1 server nào đó do xr lý qúa khả năng của nó.
  ![Alt](/thuctap/anh/Screenshot_713.png)
### 2.4 Least Time
- Thuật toán này sẽ chọn xem server nào có thời gian phản hồi nhanh nhất và chuyển các request đến ,khi server đó phải xử lý quá nhiều request rồi thì tốc độ phản hồi sẽ chậm lúc đó server nào có tốc độ phản hồi nhanh hơn thì sẽ được chuyển đến
  ![Alt](/thuctap/anh/Screenshot_714.png)

### 2.5 Health check
- Thuật toán Health Check được sử dụng để kiểm tra trạng thái và sức khỏe của các máy chủ trong cụm cân bằng tải.
- Load balancer thực hiện kiểm tra định kỳ (ví dụ: mỗi vài giây hoặc mỗi vài phút) đến các máy chủ. Nếu máy chủ không phản hồi (hoặc phản hồi sai), nó sẽ được đánh dấu là không khả dụng và các yêu cầu sẽ không được chuyển tiếp đến nó cho đến khi nó trở lại trạng thái hoạt động.
### 2.6 Nên chọn thuật toán nào để cân bằng tải

Việc chọn thuật toán cân bằng tải phụ thuộc vào nhiều yếu tố, bao gồm cấu trúc và yêu cầu của hệ thống, mục tiêu hiệu suất mong muốn và ngân sách. Dưới đây là một số lưu ý để hỗ trợ quyết định:
- Least Connection : Nếu bạn muốn chuyển tiếp yêu cầu đến máy chủ có số kết nối ít nhất.
- Round Robin : Khi bạn muốn chuyển tiếp yêu cầu theo một trật tự cố định giữa các máy chủ.
- Least Time: Khi mục tiêu là tối ưu hóa thời gian phản hồi cho người dùng cuối.
- IP Hash: Khi bạn muốn đảm bảo rằng một IP cụ thể sẽ luôn được chuyển tiếp đến cùng một máy chủ
- Health Check: Luôn nên kết hợp với một thuật toán khác để đảm bảo rằng chỉ những máy chủ có sức khỏe tốt nhất được sử dụng
# Tài liệu tham khảo
https://github.com/hocchudong/ghichep-nginx/blob/master/docs/nginx-loadbalncing.md

https://www.youtube.com/watch?v=EINOE9z3sLE